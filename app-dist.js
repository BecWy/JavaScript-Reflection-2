"use strict";let url="https://picsum.photos/300",img=document.querySelector("#picsumImg"),emailInput=document.querySelector("#email");const skip=document.querySelector("#skip"),save=document.querySelector("#save"),formFieldset=document.querySelector("#form-fieldset");let currentImageURL,newEmailAddress=emailInput.value.toLowerCase(),savedEmailAddress="test@testtesttest.com",emailAddresses={};const gallery=document.querySelector(".gallery-image-containers");document.addEventListener("DOMContentLoaded",(()=>{fetchImage(),formFieldset.style.display="none"})),skip.addEventListener("click",(()=>{fetchImage()})),save.addEventListener("click",(e=>{if(formFieldset.style.display="block",emailInput.validity.valid){e.preventDefault(),e.stopPropagation(),newEmailAddress=emailInput.value.toLowerCase();for(const e in emailAddresses)if(newEmailAddress===e){let t={url:currentImageURL};emailAddresses[e].push(t),savedEmailAddress=e;let s=document.createElement("img");document.querySelector(`.gallery-${CSS.escape(newEmailAddress)}`).appendChild(s),s.src=currentImageURL}if(newEmailAddress!==savedEmailAddress){let e={url:currentImageURL},t=[];t.push(e),emailAddresses[newEmailAddress.toLowerCase()]=t,console.log(`the email address is new - ${emailInput.value}`);let s=document.createElement("div"),l=document.createElement("h2"),a=document.createElement("img");s.appendChild(l),s.appendChild(a),gallery.appendChild(s),a.src=currentImageURL,l.innerHTML=newEmailAddress,s.classList.add(`gallery-${newEmailAddress}`)}emailInput.value="",formFieldset.style.display="none",console.log(emailAddresses),fetchImage()}}));const fetchImage=()=>{fetch(url).then((e=>(e.blob(),e.url))).then((e=>{img.src=e,currentImageURL=e})).catch((e=>{alert("Please refresh the page")}))};